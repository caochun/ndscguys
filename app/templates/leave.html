{% extends "layout.html" %}
{% block title %}请假管理{% endblock %}
{% block extra_head %}
<style>
    .filter-card {
        padding: 16px;
    }
    .section-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap;
        gap: 12px;
    }
</style>
{% endblock %}

{% block content %}
<div class="section">
    <div class="section-header">
        <h4 class="grey-text text-darken-2" style="margin: 0;">请假记录</h4>
        <a class="btn waves-effect waves-light" id="openLeaveModal">
            <i class="material-icons left">add</i>新增请假
        </a>
    </div>

    <div class="card filter-card">
        <form id="leaveFilterForm">
            <div class="row" style="margin-bottom: 0;">
                <div class="input-field col s12 m4">
                    <select id="leavePersonSelect" name="person_id" required>
                        <option value="" disabled selected>请选择人员</option>
                    </select>
                    <label>人员</label>
                </div>
                <div class="input-field col s12 m3">
                    <input type="date" id="leaveStartDate" name="start_date">
                    <label for="leaveStartDate" class="active">开始日期</label>
                </div>
                <div class="input-field col s12 m3">
                    <input type="date" id="leaveEndDate" name="end_date">
                    <label for="leaveEndDate" class="active">结束日期</label>
                </div>
                <div class="input-field col s12 m2" style="margin-top: 24px;">
                    <button class="btn waves-effect waves-light" type="submit">
                        查询
                    </button>
                </div>
            </div>
        </form>
    </div>

    <div class="card">
        <div class="card-content">
            <table class="striped responsive-table">
                <thead>
                <tr>
                    <th>日期</th>
                    <th>类型</th>
                    <th>时长(小时)</th>
                    <th>状态</th>
                    <th>审批人</th>
                    <th>事由</th>
                </tr>
                </thead>
                <tbody id="leaveTableBody">
                <tr>
                    <td colspan="6" class="center-align grey-text">请选择人员进行查询</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<!-- 新增请假 Modal -->
<div id="leaveModal" class="modal modal-fixed-footer">
    <div class="modal-content">
        <h5>新增请假</h5>
        <form id="leaveForm">
            <div class="row">
                <div class="input-field col s12 m6">
                    <select id="leavePersonField" name="person_id" required>
                        <option value="" disabled selected>请选择人员</option>
                    </select>
                    <label>人员</label>
                </div>
                <div class="input-field col s12 m6">
                    <input type="date" id="leaveDate" name="leave_date" required>
                    <label for="leaveDate" class="active">日期</label>
                </div>
                <div class="input-field col s12 m6">
                    <select id="leaveType" name="leave_type" required>
                        <option value="事假" selected>事假</option>
                        <option value="病假">病假</option>
                        <option value="年假">年假</option>
                        <option value="调休">调休</option>
                        <option value="产假">产假</option>
                    </select>
                    <label>请假类型</label>
                </div>
                <div class="input-field col s12 m6">
                    <input type="number" id="leaveHours" name="hours" step="0.5" min="0.5" value="8" required>
                    <label for="leaveHours">时长(小时)</label>
                </div>
                <div class="input-field col s12">
                    <textarea id="leaveReason" name="reason" class="materialize-textarea"></textarea>
                    <label for="leaveReason">请假事由</label>
                </div>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <a href="#!" class="modal-close waves-effect waves-green btn-flat">取消</a>
        <button type="submit" form="leaveForm" class="btn waves-effect waves-light">提交</button>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/leave.js') }}"></script>
{% endblock %}

